<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Impostazioni - AI Influencer Control Hub</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="header-bar">
        <h1>Impostazioni</h1>
        <nav class="app-nav">
          <a href="/"{% if active_nav == "home" %} aria-current="page"{% endif %}
            >Generazione contenuti</a
          >
          <a href="/influencer"{% if active_nav == "influencer" %} aria-current="page"{% endif %}
            >Analisi influencer</a
          >
          <a href="/dati"{% if active_nav == "data" %} aria-current="page"{% endif %}
            >Dati</a
          >
          <a href="/settings"{% if active_nav == "settings" %} aria-current="page"{% endif %}
            >Impostazioni</a
          >
        </nav>
      </div>
      <p>
        Gestisci le integrazioni con i servizi esterni utilizzati dall'applicazione.
        Le modifiche vengono salvate immediatamente nell'ambiente di esecuzione.
      </p>
    </header>

    <main class="settings-layout">
      <section class="card settings-card">
        <h2>Servizi esterni</h2>
        <p class="settings-description">
          Consulta e aggiorna la configurazione dei servizi supportati. Le chiavi API
          vengono memorizzate nell'ambiente di esecuzione e mostrate solo in forma
          mascherata. Gli endpoint personalizzati sono facoltativi.
        </p>
        <div class="table-wrapper">
          <table class="settings-table" id="services-table">
            <thead>
              <tr>
                <th scope="col">Servizio</th>
                <th scope="col">Endpoint</th>
                <th scope="col">Chiave</th>
                <th scope="col" class="actions">Azioni</th>
              </tr>
            </thead>
            <tbody id="services-table-body">
              <tr class="empty">
                <td colspan="4">Caricamento servizi...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <dialog id="service-dialog" class="settings-dialog">
      <form
        id="service-form"
        class="form settings-form"
        method="dialog"
        autocomplete="off"
      >
        <h3 id="service-dialog-title">Modifica servizio</h3>
        <input type="hidden" id="service-id" name="service_id" />
        <p id="service-env-hint" class="input-hint"></p>
        <label>
          Chiave API
          <input
            type="password"
            id="service-api-key"
            name="api_key"
            placeholder="sk-..."
            autocomplete="off"
          />
          <span class="input-hint">
            Inserisci una nuova chiave per sostituire quella esistente.
          </span>
        </label>
        <label>
          Endpoint personalizzato (facoltativo)
          <input
            type="url"
            id="service-endpoint"
            name="endpoint"
            autocomplete="off"
          />
          <span class="input-hint">
            Lascia vuoto per utilizzare l'endpoint predefinito del servizio.
          </span>
        </label>
        <div class="settings-actions">
          <button type="submit">Salva</button>
          <button type="button" id="service-cancel" class="button-secondary">
            Annulla
          </button>
        </div>
      </form>
    </dialog>

    <script src="/static/settings.js" type="module"></script>
  </body>
</html>
